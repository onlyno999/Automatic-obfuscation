const a0V=a0b;(function(a,b){const U=a0b,c=a();while(!![]){try{const d=-parseInt(U(0xf1))/0x1*(parseInt(U(0xf6))/0x2)+-parseInt(U(0x100))/0x3+-parseInt(U(0xcf))/0x4*(-parseInt(U(0xe3))/0x5)+-parseInt(U(0xc7))/0x6*(-parseInt(U(0xc1))/0x7)+-parseInt(U(0xbe))/0x8+parseInt(U(0xd7))/0x9+parseInt(U(0xea))/0xa;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0xce0c9));function a0a(){const ac=['values','opened','2406ZIZzlC','dmxlc3M=','text/html;\x20charset=utf-8','getUint8','readable','enqueue','1f9d104e-ca0e-4202-ba4b-a0afb969c748','catch','4mOqHio','/?ed=2560','tls','arrayBuffer','icook.tw:443','push','https://cf-worker-dir-bke.pages.dev/','japan.com:443','11387205BtcaSm','set','slice','www.visa.com.hk:443','user','getUint16','POST','content-type','pathname','close','url','toLowerCase','6169195PAzbgz','wok.woxxxxxx.nyc.mn:443','no-store,\x20no-cache,\x20must-revalidate,\x20max-age=0','Cache-Control','www.visa.com.sg:443','get','<base\x20href=\x22','6222750iuPimY','text/html','error','join','getWriter','proxy','direct','1BeBhcl','getReader','indexOf','status','searchParams','2383222OanAYw','substring','port','split','sec-websocket-protocol','byteLength','writable','auto','icook.hk:443','write','1976523PqATnT','%3F','forEach','charCodeAt','text/plain;\x20charset=utf-8','mode','read','value','replace','encode','hostname','decode','proxyip','delete','websocket','pipeTo','from','method','substr','test','bestcf.030101.xyz:443','addEventListener','toString','https://1.1.1.1/dns-query','releaseLock','cf-worker-masquerade','none','data','<h1>伪装页面加载失败</h1>','3566216SMUzKn','send','length','329OQyysx','includes','readyState','headers'];a0a=function(){return ac;};return a0a();}import{connect}from'cloudflare:sockets';const a0c=a0V(0xcd),a0d=a0V(0xe4),a0e=[a0V(0xb5),a0V(0xd6),a0V(0xe7),a0V(0xda),a0V(0xfe),a0V(0xd3)],a0f=a0V(0xd5);export default{async 'fetch'(a){const W=a0V,b=new URL(a[W(0xe1)]);if(a[W(0xc4)][W(0xe8)]('Upgrade')?.['toLowerCase']()===W(0xaf))return await a0j(a);else{if(a[W(0xb2)]==='GET'){if(b['pathname']==='/')return await a0g(a);else{if(b[W(0xdf)][W(0xe2)]()[W(0xc2)]('/'+a0c))return await a0h(a);}}}return new Response('error',{'status':0x194});}};async function a0g(a){const X=a0V;try{const b=await fetch(a0f,{'headers':{'User-Agent':a[X(0xc4)][X(0xe8)]('User-Agent')||X(0xba)}}),c=b['headers'][X(0xe8)]('content-type')||'';if(c[X(0xc2)](X(0xeb))){let d=await b['text']();const e=X(0xe9)+a0f+'\x22>';/<head[^>]*>/i[X(0xb4)](d)?d=d['replace'](/<head[^>]*>/i,g=>g+'\x0a'+e+'\x0a'):d=e+'\x0a'+d;const f=new Headers(b[X(0xc4)]);return f[X(0xd8)](X(0xde),X(0xc9)),f[X(0xae)]('content-length'),f['set'](X(0xe6),X(0xe5)),new Response(d,{'status':b[X(0xf4)],'headers':f});}else{const g=new Headers(b['headers']);return g[X(0xd8)]('Cache-Control',X(0xe5)),new Response(await b[X(0xd2)](),{'status':b['status'],'headers':g});}}catch(h){return new Response(X(0xbd),{'status':0x1f6,'headers':{'Content-Type':X(0xc9)}});}}function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0xac;let f=c[d];return f;},a0b(a,b);}async function a0h(a){const Y=a0V,b=new URL(a[Y(0xe1)]),c=b[Y(0x10a)];let d=a0i(c),e=btoa(d[Y(0xed)]('\x0a'));return new Response(e,{'headers':{'Content-Type':Y(0x104),'Cache-Control':Y(0xe5)}});}function a0i(a){const Z=a0V;let b=[],c=0x0;const d=Z(0xd0),e=atob(Z(0xc8));return a0e[Z(0x102)](f=>{const a0=Z;c+=0x1;let g='snippet_'+c;const h=new URLSearchParams({'encryption':a0(0xbb),'security':a0(0xd1),'sni':a,'fp':'chrome','type':'ws','host':a,'path':d});b[a0(0xd4)](e+'://'+a0c+'@'+f+'?'+h[a0(0xb7)]()+'#'+encodeURIComponent(g));}),b;}async function a0j(a){const a1=a0V,[b,c]=Object[a1(0xc5)](new WebSocketPair());c['accept']();const d=new URL(a[a1(0xe1)]);if(d[a1(0xdf)][a1(0xc2)](a1(0x101))){const p=decodeURIComponent(d[a1(0xdf)]),q=p[a1(0xf3)]('?');q!==-0x1&&(d['search']=p[a1(0xf7)](q),d[a1(0xdf)]=p[a1(0xf7)](0x0,q));}const e=d[a1(0xf5)][a1(0xe8)](a1(0x105))||a1(0xef),f=d[a1(0xf5)][a1(0xe8)]('s5'),g=d[a1(0xf5)][a1(0xe8)](a1(0xad)),h=f?f:d[a1(0xdf)][a1(0xd9)](0x1),i=h[a1(0xc2)]('@')?((()=>{const a2=a1,[r,s]=h[a2(0xf9)]('@'),[t,v]=r[a2(0xf9)](':'),[w,x=0x1bb]=s[a2(0xf9)](':');return{'user':t,'pass':v,'host':w,'port':+x};})()):null,j=g?String(g):a0d,k=()=>{const a3=a1;if(e==='proxy')return[a3(0xf0),a3(0xef)];if(e!==a3(0xfd))return[e];const r=[],s=d['search']['slice'](0x1);for(const t of s['split']('&')){const v=t[a3(0xf9)]('=')[0x0];if(v==='direct')r[a3(0xd4)](a3(0xf0));else{if(v==='s5')r['push']('s5');else{if(v===a3(0xad))r[a3(0xd4)]('proxy');}}}return r['length']?r:[a3(0xf0)];};let l=null,m=null,n=![];const o=async(s,t)=>{const a4=a1,v=connect({'hostname':i['host'],'port':i[a4(0xf8)]});await v['opened'];const x=v[a4(0xfc)]['getWriter'](),y=v[a4(0xcb)][a4(0xf2)]();await x[a4(0xff)](new Uint8Array([0x5,0x2,0x0,0x2]));const z=(await y['read']())[a4(0x107)];if(z[0x1]===0x2&&i[a4(0xdb)]){const B=new TextEncoder()['encode'](i[a4(0xdb)]),C=new TextEncoder()[a4(0x109)](i['pass']);await x['write'](new Uint8Array([0x1,B[a4(0xc0)],...B,C[a4(0xc0)],...C])),await y[a4(0x106)]();}const A=new TextEncoder()['encode'](s);return await x['write'](new Uint8Array([0x5,0x1,0x0,0x3,A[a4(0xc0)],...A,t>>0x8,t&0xff])),await y['read'](),x[a4(0xb9)](),y[a4(0xb9)](),v;};return new ReadableStream({'start'(r){const a5=a1;c[a5(0xb6)]('message',t=>r[a5(0xcc)](t[a5(0xbc)])),c['addEventListener'](a5(0xe0),()=>{const a6=a5;l?.['close'](),r[a6(0xe0)]();}),c[a5(0xb6)](a5(0xec),()=>{const a7=a5;l?.[a7(0xe0)](),r['error']();});const s=a[a5(0xc4)][a5(0xe8)](a5(0xfa));if(s)try{r['enqueue'](Uint8Array[a5(0xb1)](atob(s[a5(0x108)](/-/g,'+')[a5(0x108)](/_/g,'/')),t=>t[a5(0x103)](0x0))['buffer']);}catch{}}})[a1(0xb0)](new WritableStream({async 'write'(r){const a8=a1;if(n)return m?.[a8(0xff)](r);if(l){const I=l['writable'][a8(0xee)]();await I[a8(0xff)](r),I['releaseLock']();return;}if(r[a8(0xfb)]<0x18)return;const s=new Uint8Array(r[a8(0xd9)](0x1,0x11)),t=a0c[a8(0x108)](/-/g,'');for(let J=0x0;J<0x10;J++){if(s[J]!==parseInt(t[a8(0xb3)](J*0x2,0x2),0x10))return;}const v=new DataView(r),x=v['getUint8'](0x11),y=v['getUint8'](0x12+x);if(y!==0x1&&y!==0x2)return;let z=0x13+x;const A=v[a8(0xdc)](z),B=v[a8(0xca)](z+0x2);z+=0x3;let C='';if(B===0x1)C=v[a8(0xca)](z)+'.'+v[a8(0xca)](z+0x1)+'.'+v['getUint8'](z+0x2)+'.'+v['getUint8'](z+0x3),z+=0x4;else{if(B===0x2){const K=v[a8(0xca)](z++);C=new TextDecoder()[a8(0xac)](r[a8(0xd9)](z,z+K)),z+=K;}else{if(B===0x3){const L=[];for(let M=0x0;M<0x8;M++,z+=0x2)L['push'](v[a8(0xdc)](z)['toString'](0x10));C=L[a8(0xed)](':');}else return;}}const D=new Uint8Array([r[0x0],0x0]),E=r[a8(0xd9)](z);if(y===0x2){if(A!==0x35)return;n=!![];let N=![];const {readable:O,writable:P}=new TransformStream({'transform'(Q,R){const a9=a8;for(let S=0x0;S<Q[a9(0xfb)];){const T=new DataView(Q[a9(0xd9)](S,S+0x2))[a9(0xdc)](0x0);R[a9(0xcc)](Q[a9(0xd9)](S+0x2,S+0x2+T)),S+=0x2+T;}}});return O['pipeTo'](new WritableStream({async 'write'(Q){const aa=a8;try{const R=await fetch(aa(0xb8),{'method':aa(0xdd),'headers':{'content-type':'application/dns-message'},'body':Q});if(c[aa(0xc3)]===0x1){const S=new Uint8Array(await R[aa(0xd2)]());c['send'](new Uint8Array([...N?[]:D,S['length']>>0x8,S[aa(0xc0)]&0xff,...S])),N=!![];}}catch{}}})),m=P[a8(0xee)](),m['write'](E);}let F=null;for(const Q of k()){try{if(Q==='direct'){F=connect({'hostname':C,'port':A}),await F[a8(0xc6)];break;}else{if(Q==='s5'&&i){F=await o(C,A);break;}else{if(Q===a8(0xef)&&j){const [R,S=A]=j[a8(0xf9)](':');F=connect({'hostname':R,'port':+S||A}),await F['opened'];break;}}}}catch{}}if(!F)return;l=F;const G=F[a8(0xfc)][a8(0xee)]();await G['write'](E),G[a8(0xb9)]();let H=![];F['readable'][a8(0xb0)](new WritableStream({'write'(T){const ab=a8;c['readyState']===0x1&&(c[ab(0xbf)](H?T:new Uint8Array([...D,...new Uint8Array(T)])),H=!![]);},'close':()=>c['readyState']===0x1&&c[a8(0xe0)](),'abort':()=>c['readyState']===0x1&&c[a8(0xe0)]()}))[a8(0xce)](()=>{});}}))[a1(0xce)](()=>{}),new Response(null,{'status':0x65,'webSocket':b});}