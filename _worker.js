const a0V=a0b;function a0a(){const ab=['4957320EGbGxm','port','search','hostname','getWriter','2440qpqgxG','read','enqueue','toLowerCase','releaseLock','bestcf.030101.xyz:443','get','56951EdkcpF','snippet_','method','send','pipeTo','14vlcFdA','https://1.1.1.1/dns-query','forEach','GET','catch','tls','accept','3131508FHpIpu','11578610ntWUge','436878pcERzj','join','toString','writable','getUint8','bestproxy.030101.xyz:443','35413nGSvOa','write','<h1>success</h1>','sec-websocket-protocol','push','6571065uWhmsz','/?ed=2048','chrome','substr','replace','1f9d104e-ca0e-4202-ba4b-a0afb969c747','opened','values','://','readable','no-store,\x20no-cache,\x20must-revalidate,\x20max-age=0','auto','addEventListener','split','headers','error','pathname','host','decode','readyState','user','charCodeAt','proxy','message','encode','close','length','buffer','getUint16','icook.hk:443','direct','includes','pass','url','none','byteLength','9WBNBKf','proxyip','slice','text/html;\x20charset=utf-8','mode','dmxlc3M=','searchParams'];a0a=function(){return ab;};return a0a();}function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0x1ec;let f=c[d];return f;},a0b(a,b);}(function(a,b){const U=a0b,c=a();while(!![]){try{const d=-parseInt(U(0x223))/0x1*(-parseInt(U(0x228))/0x2)+-parseInt(U(0x217))/0x3+parseInt(U(0x22f))/0x4+-parseInt(U(0x1ec))/0x5+-parseInt(U(0x231))/0x6+-parseInt(U(0x237))/0x7*(-parseInt(U(0x21c))/0x8)+-parseInt(U(0x210))/0x9*(-parseInt(U(0x230))/0xa);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0xcdcac));import{connect}from'cloudflare:sockets';const a0c=a0V(0x1f1),a0d=a0V(0x236),a0e=[a0V(0x221),'japan.com:443','www.visa.com.sg:443','www.visa.com.hk:443',a0V(0x209),'icook.tw:443'];export default{async 'fetch'(a){const W=a0V,b=new URL(a[W(0x20d)]);if(a['headers'][W(0x222)]('Upgrade')?.[W(0x21f)]()==='websocket')return await a0h(a);else{if(a[W(0x225)]===W(0x22b)){if(b[W(0x1fc)]==='/'){const c=W(0x239);return new Response(c,{'status':0xc8,'headers':{'Content-Type':W(0x213)}});}else{if(b[W(0x1fc)][W(0x21f)]()['includes']('/'+a0c))return await a0f(a);}}}return new Response('error',{'status':0x194});}};async function a0f(a){const X=a0V,b=new URL(a[X(0x20d)]),c=b[X(0x21a)];let d=a0g(c),e=btoa(d['join']('\x0a'));return new Response(e,{'headers':{'Content-Type':'text/plain;\x20charset=utf-8','Cache-Control':X(0x1f6)}});}function a0g(a){const Y=a0V;let b=[],c=0x0;const d=encodeURIComponent(Y(0x1ed)),e=atob(Y(0x215));return a0e[Y(0x22a)](f=>{const Z=Y;c+=0x1;let g=Z(0x224)+c;const h=new URLSearchParams({'encryption':Z(0x20e),'security':Z(0x22d),'sni':a,'fp':Z(0x1ee),'type':'ws','host':a,'path':d});b['push'](e+Z(0x1f4)+a0c+'@'+f+'?'+h[Z(0x233)]()+'#'+encodeURIComponent(g));}),b;}async function a0h(a){const a0=a0V,[b,c]=Object[a0(0x1f3)](new WebSocketPair());c[a0(0x22e)]();const d=new URL(a[a0(0x20d)]);if(d[a0(0x1fc)][a0(0x20b)]('%3F')){const p=decodeURIComponent(d[a0(0x1fc)]),q=p['indexOf']('?');q!==-0x1&&(d[a0(0x219)]=p['substring'](q),d[a0(0x1fc)]=p['substring'](0x0,q));}const e=d[a0(0x216)][a0(0x222)](a0(0x214))||a0(0x202),f=d['searchParams'][a0(0x222)]('s5'),g=d[a0(0x216)]['get'](a0(0x211)),h=f?f:d['pathname'][a0(0x212)](0x1),i=h['includes']('@')?((()=>{const a1=a0,[r,s]=h[a1(0x1f9)]('@'),[t,v]=r[a1(0x1f9)](':'),[w,x=0x1bb]=s[a1(0x1f9)](':');return{'user':t,'pass':v,'host':w,'port':+x};})()):null,j=g?String(g):a0d,k=()=>{const a2=a0;if(e==='proxy')return[a2(0x20a),a2(0x202)];if(e!==a2(0x1f7))return[e];const r=[],s=d[a2(0x219)][a2(0x212)](0x1);for(const t of s[a2(0x1f9)]('&')){const v=t[a2(0x1f9)]('=')[0x0];if(v===a2(0x20a))r[a2(0x23b)](a2(0x20a));else{if(v==='s5')r[a2(0x23b)]('s5');else{if(v===a2(0x211))r[a2(0x23b)](a2(0x202));}}}return r[a2(0x206)]?r:[a2(0x20a)];};let l=null,m=null,n=![];const o=async(s,t)=>{const a3=a0,v=connect({'hostname':i[a3(0x1fd)],'port':i[a3(0x218)]});await v[a3(0x1f2)];const x=v[a3(0x234)]['getWriter'](),y=v['readable']['getReader']();await x[a3(0x238)](new Uint8Array([0x5,0x2,0x0,0x2]));const z=(await y[a3(0x21d)]())['value'];if(z[0x1]===0x2&&i[a3(0x200)]){const B=new TextEncoder()[a3(0x204)](i[a3(0x200)]),C=new TextEncoder()[a3(0x204)](i[a3(0x20c)]);await x[a3(0x238)](new Uint8Array([0x1,B[a3(0x206)],...B,C[a3(0x206)],...C])),await y[a3(0x21d)]();}const A=new TextEncoder()[a3(0x204)](s);return await x[a3(0x238)](new Uint8Array([0x5,0x1,0x0,0x3,A[a3(0x206)],...A,t>>0x8,t&0xff])),await y[a3(0x21d)](),x['releaseLock'](),y[a3(0x220)](),v;};return new ReadableStream({'start'(r){const a4=a0;c[a4(0x1f8)](a4(0x203),t=>r['enqueue'](t['data'])),c[a4(0x1f8)](a4(0x205),()=>{const a5=a4;l?.['close'](),r[a5(0x205)]();}),c[a4(0x1f8)]('error',()=>{const a6=a4;l?.['close'](),r[a6(0x1fb)]();});const s=a[a4(0x1fa)][a4(0x222)](a4(0x23a));if(s)try{r['enqueue'](Uint8Array['from'](atob(s['replace'](/-/g,'+')['replace'](/_/g,'/')),t=>t[a4(0x201)](0x0))[a4(0x207)]);}catch{}}})[a0(0x227)](new WritableStream({async 'write'(r){const a7=a0;if(n)return m?.[a7(0x238)](r);if(l){const I=l[a7(0x234)][a7(0x21b)]();await I[a7(0x238)](r),I[a7(0x220)]();return;}if(r[a7(0x20f)]<0x18)return;const s=new Uint8Array(r[a7(0x212)](0x1,0x11)),t=a0c[a7(0x1f0)](/-/g,'');for(let J=0x0;J<0x10;J++){if(s[J]!==parseInt(t[a7(0x1ef)](J*0x2,0x2),0x10))return;}const v=new DataView(r),x=v[a7(0x235)](0x11),y=v['getUint8'](0x12+x);if(y!==0x1&&y!==0x2)return;let z=0x13+x;const A=v[a7(0x208)](z),B=v[a7(0x235)](z+0x2);z+=0x3;let C='';if(B===0x1)C=v[a7(0x235)](z)+'.'+v[a7(0x235)](z+0x1)+'.'+v[a7(0x235)](z+0x2)+'.'+v['getUint8'](z+0x3),z+=0x4;else{if(B===0x2){const K=v['getUint8'](z++);C=new TextDecoder()[a7(0x1fe)](r['slice'](z,z+K)),z+=K;}else{if(B===0x3){const L=[];for(let M=0x0;M<0x8;M++,z+=0x2)L[a7(0x23b)](v['getUint16'](z)[a7(0x233)](0x10));C=L[a7(0x232)](':');}else return;}}const D=new Uint8Array([r[0x0],0x0]),E=r[a7(0x212)](z);if(y===0x2){if(A!==0x35)return;n=!![];let N=![];const {readable:O,writable:P}=new TransformStream({'transform'(Q,R){const a8=a7;for(let S=0x0;S<Q[a8(0x20f)];){const T=new DataView(Q[a8(0x212)](S,S+0x2))[a8(0x208)](0x0);R[a8(0x21e)](Q[a8(0x212)](S+0x2,S+0x2+T)),S+=0x2+T;}}});return O[a7(0x227)](new WritableStream({async 'write'(Q){const a9=a7;try{const R=await fetch(a9(0x229),{'method':'POST','headers':{'content-type':'application/dns-message'},'body':Q});if(c[a9(0x1ff)]===0x1){const S=new Uint8Array(await R['arrayBuffer']());c[a9(0x226)](new Uint8Array([...N?[]:D,S[a9(0x206)]>>0x8,S[a9(0x206)]&0xff,...S])),N=!![];}}catch{}}})),m=P[a7(0x21b)](),m[a7(0x238)](E);}let F=null;for(const Q of k()){try{if(Q===a7(0x20a)){F=connect({'hostname':C,'port':A}),await F[a7(0x1f2)];break;}else{if(Q==='s5'&&i){F=await o(C,A);break;}else{if(Q===a7(0x202)&&j){const [R,S=A]=j[a7(0x1f9)](':');F=connect({'hostname':R,'port':+S||A}),await F[a7(0x1f2)];break;}}}}catch{}}if(!F)return;l=F;const G=F[a7(0x234)][a7(0x21b)]();await G[a7(0x238)](E),G[a7(0x220)]();let H=![];F[a7(0x1f5)]['pipeTo'](new WritableStream({'write'(T){const aa=a7;c[aa(0x1ff)]===0x1&&(c[aa(0x226)](H?T:new Uint8Array([...D,...new Uint8Array(T)])),H=!![]);},'close':()=>c[a7(0x1ff)]===0x1&&c['close'](),'abort':()=>c[a7(0x1ff)]===0x1&&c[a7(0x205)]()}))[a7(0x22c)](()=>{});}}))[a0(0x22c)](()=>{}),new Response(null,{'status':0x65,'webSocket':b});}