const a0V=a0b;(function(a,b){const U=a0b,c=a();while(!![]){try{const d=-parseInt(U(0xb9))/0x1*(parseInt(U(0x7c))/0x2)+-parseInt(U(0x86))/0x3+-parseInt(U(0x85))/0x4*(parseInt(U(0xac))/0x5)+-parseInt(U(0xc8))/0x6+-parseInt(U(0xc7))/0x7+parseInt(U(0xc5))/0x8+-parseInt(U(0xbc))/0x9*(-parseInt(U(0x8d))/0xa);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0x901d9));import{connect}from'cloudflare:sockets';function a0a(){const ab=['get','charCodeAt','pathname','dmxlc3M=','Upgrade','read','1f9d104e-ca0e-4202-ba4b-a0afb969c747','values','getUint16','://','proxy','getUint8','getWriter','push','readyState','slice','getReader','buffer','arrayBuffer','headers','length','%3F','icook.tw:443','value','user','searchParams','423815spQhKi','proxyip','url','message','substr','chrome','opened','join','encode','writable','sec-websocket-protocol','host','includes','214qxLRDm','bestproxy.030101.xyz:443','text/html;\x20charset=utf-8','477441AlDxjN','toLowerCase','<h1>success</h1>','catch','text/plain;\x20charset=utf-8','no-store,\x20no-cache,\x20must-revalidate,\x20max-age=0','mode','readable','send','3037344ZKvstU','close','5157684guVYlR','1900332Xxbgtl','toString','search','addEventListener','byteLength','forEach','data','enqueue','pipeTo','7404KemzTC','releaseLock','snippet_','port','error','pass','from','www.visa.com.hk:443','tls','8ppLwBn','802158kyLcWy','icook.hk:443','write','substring','hostname','replace','application/dns-message','470xDJTHI','direct','split','www.visa.com.sg:443','accept'];a0a=function(){return ab;};return a0a();}function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0x7c;let f=c[d];return f;},a0b(a,b);}const a0c=a0V(0x98),a0d=a0V(0xba),a0e=['bestcf.030101.xyz:443','japan.com:443',a0V(0x90),a0V(0x83),a0V(0x87),a0V(0xa8)];export default{async 'fetch'(a){const W=a0V,b=new URL(a[W(0xae)]);if(a[W(0xa5)][W(0x92)](W(0x96))?.[W(0xbd)]()==='websocket')return await a0h(a);else{if(a['method']==='GET'){if(b[W(0x94)]==='/'){const c=W(0xbe);return new Response(c,{'status':0xc8,'headers':{'Content-Type':W(0xbb)}});}else{if(b[W(0x94)][W(0xbd)]()[W(0xb8)]('/'+a0c))return await a0f(a);}}}return new Response(W(0x80),{'status':0x194});}};async function a0f(a){const X=a0V,b=new URL(a['url']),c=b[X(0x8a)];let d=a0g(c),e=btoa(d[X(0xb3)]('\x0a'));return new Response(e,{'headers':{'Content-Type':X(0xc0),'Cache-Control':X(0xc1)}});}function a0g(a){const Y=a0V;let b=[],c=0x0;const d=encodeURIComponent('/?ed=2048'),e=atob(Y(0x95));return a0e[Y(0xcd)](f=>{const Z=Y;c+=0x1;let g=Z(0x7e)+c;const h=new URLSearchParams({'encryption':'none','security':Z(0x84),'sni':a,'fp':Z(0xb1),'type':'ws','host':a,'path':d});b[Z(0x9f)](e+Z(0x9b)+a0c+'@'+f+'?'+h[Z(0xc9)]()+'#'+encodeURIComponent(g));}),b;}async function a0h(a){const a0=a0V,[b,c]=Object[a0(0x99)](new WebSocketPair());c[a0(0x91)]();const d=new URL(a[a0(0xae)]);if(d['pathname'][a0(0xb8)](a0(0xa7))){const p=decodeURIComponent(d[a0(0x94)]),q=p['indexOf']('?');q!==-0x1&&(d['search']=p['substring'](q),d[a0(0x94)]=p[a0(0x89)](0x0,q));}const e=d[a0(0xab)][a0(0x92)](a0(0xc2))||a0(0x9c),f=d['searchParams'][a0(0x92)]('s5'),g=d[a0(0xab)][a0(0x92)](a0(0xad)),h=f?f:d[a0(0x94)]['slice'](0x1),i=h[a0(0xb8)]('@')?((()=>{const a1=a0,[r,s]=h[a1(0x8f)]('@'),[t,v]=r[a1(0x8f)](':'),[w,x=0x1bb]=s['split'](':');return{'user':t,'pass':v,'host':w,'port':+x};})()):null,j=g?String(g):a0d,k=()=>{const a2=a0;if(e==='proxy')return[a2(0x8e),a2(0x9c)];if(e!=='auto')return[e];const r=[],s=d[a2(0xca)][a2(0xa1)](0x1);for(const t of s[a2(0x8f)]('&')){const v=t[a2(0x8f)]('=')[0x0];if(v===a2(0x8e))r['push']('direct');else{if(v==='s5')r['push']('s5');else{if(v===a2(0xad))r['push']('proxy');}}}return r['length']?r:[a2(0x8e)];};let l=null,m=null,n=![];const o=async(s,t)=>{const a3=a0,v=connect({'hostname':i[a3(0xb7)],'port':i[a3(0x7f)]});await v[a3(0xb2)];const x=v['writable'][a3(0x9e)](),y=v[a3(0xc3)][a3(0xa2)]();await x[a3(0x88)](new Uint8Array([0x5,0x2,0x0,0x2]));const z=(await y[a3(0x97)]())[a3(0xa9)];if(z[0x1]===0x2&&i[a3(0xaa)]){const B=new TextEncoder()[a3(0xb4)](i[a3(0xaa)]),C=new TextEncoder()[a3(0xb4)](i[a3(0x81)]);await x['write'](new Uint8Array([0x1,B['length'],...B,C[a3(0xa6)],...C])),await y[a3(0x97)]();}const A=new TextEncoder()[a3(0xb4)](s);return await x[a3(0x88)](new Uint8Array([0x5,0x1,0x0,0x3,A[a3(0xa6)],...A,t>>0x8,t&0xff])),await y[a3(0x97)](),x[a3(0x7d)](),y[a3(0x7d)](),v;};return new ReadableStream({'start'(r){const a4=a0;c['addEventListener'](a4(0xaf),t=>r[a4(0xcf)](t[a4(0xce)])),c[a4(0xcb)](a4(0xc6),()=>{const a5=a4;l?.[a5(0xc6)](),r[a5(0xc6)]();}),c[a4(0xcb)](a4(0x80),()=>{const a6=a4;l?.[a6(0xc6)](),r[a6(0x80)]();});const s=a[a4(0xa5)][a4(0x92)](a4(0xb6));if(s)try{r[a4(0xcf)](Uint8Array[a4(0x82)](atob(s[a4(0x8b)](/-/g,'+')[a4(0x8b)](/_/g,'/')),t=>t[a4(0x93)](0x0))[a4(0xa3)]);}catch{}}})[a0(0xd0)](new WritableStream({async 'write'(r){const a7=a0;if(n)return m?.[a7(0x88)](r);if(l){const I=l['writable'][a7(0x9e)]();await I[a7(0x88)](r),I[a7(0x7d)]();return;}if(r['byteLength']<0x18)return;const s=new Uint8Array(r[a7(0xa1)](0x1,0x11)),t=a0c[a7(0x8b)](/-/g,'');for(let J=0x0;J<0x10;J++){if(s[J]!==parseInt(t[a7(0xb0)](J*0x2,0x2),0x10))return;}const v=new DataView(r),x=v['getUint8'](0x11),y=v[a7(0x9d)](0x12+x);if(y!==0x1&&y!==0x2)return;let z=0x13+x;const A=v['getUint16'](z),B=v[a7(0x9d)](z+0x2);z+=0x3;let C='';if(B===0x1)C=v[a7(0x9d)](z)+'.'+v[a7(0x9d)](z+0x1)+'.'+v[a7(0x9d)](z+0x2)+'.'+v[a7(0x9d)](z+0x3),z+=0x4;else{if(B===0x2){const K=v[a7(0x9d)](z++);C=new TextDecoder()['decode'](r[a7(0xa1)](z,z+K)),z+=K;}else{if(B===0x3){const L=[];for(let M=0x0;M<0x8;M++,z+=0x2)L['push'](v[a7(0x9a)](z)['toString'](0x10));C=L[a7(0xb3)](':');}else return;}}const D=new Uint8Array([r[0x0],0x0]),E=r[a7(0xa1)](z);if(y===0x2){if(A!==0x35)return;n=!![];let N=![];const {readable:O,writable:P}=new TransformStream({'transform'(Q,R){const a8=a7;for(let S=0x0;S<Q[a8(0xcc)];){const T=new DataView(Q[a8(0xa1)](S,S+0x2))[a8(0x9a)](0x0);R[a8(0xcf)](Q[a8(0xa1)](S+0x2,S+0x2+T)),S+=0x2+T;}}});return O[a7(0xd0)](new WritableStream({async 'write'(Q){const a9=a7;try{const R=await fetch('https://1.1.1.1/dns-query',{'method':'POST','headers':{'content-type':a9(0x8c)},'body':Q});if(c['readyState']===0x1){const S=new Uint8Array(await R[a9(0xa4)]());c[a9(0xc4)](new Uint8Array([...N?[]:D,S[a9(0xa6)]>>0x8,S[a9(0xa6)]&0xff,...S])),N=!![];}}catch{}}})),m=P[a7(0x9e)](),m[a7(0x88)](E);}let F=null;for(const Q of k()){try{if(Q===a7(0x8e)){F=connect({'hostname':C,'port':A}),await F['opened'];break;}else{if(Q==='s5'&&i){F=await o(C,A);break;}else{if(Q===a7(0x9c)&&j){const [R,S=A]=j[a7(0x8f)](':');F=connect({'hostname':R,'port':+S||A}),await F[a7(0xb2)];break;}}}}catch{}}if(!F)return;l=F;const G=F[a7(0xb5)][a7(0x9e)]();await G[a7(0x88)](E),G['releaseLock']();let H=![];F[a7(0xc3)][a7(0xd0)](new WritableStream({'write'(T){const aa=a7;c[aa(0xa0)]===0x1&&(c[aa(0xc4)](H?T:new Uint8Array([...D,...new Uint8Array(T)])),H=!![]);},'close':()=>c[a7(0xa0)]===0x1&&c[a7(0xc6)](),'abort':()=>c[a7(0xa0)]===0x1&&c[a7(0xc6)]()}))[a7(0xbf)](()=>{});}}))[a0(0xbf)](()=>{}),new Response(null,{'status':0x65,'webSocket':b});}