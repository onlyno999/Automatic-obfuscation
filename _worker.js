function a0b(a,b){a=a-0xda;const c=a0a();let d=c[a];return d;}const a0Z=a0b;(function(a,b){const Y=a0b,c=a();while(!![]){try{const d=parseInt(Y(0x13b))/0x1+-parseInt(Y(0x133))/0x2*(-parseInt(Y(0xf7))/0x3)+parseInt(Y(0x124))/0x4+parseInt(Y(0x142))/0x5+parseInt(Y(0x127))/0x6*(-parseInt(Y(0xdc))/0x7)+parseInt(Y(0x139))/0x8*(parseInt(Y(0x132))/0x9)+-parseInt(Y(0x118))/0xa;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0x95348));import{connect}from'cloudflare:sockets';let a0c=a0Z(0x12b);const a0d=0x2*0x400*0x400,a0e=0x3a98,a0f=0x1f40,a0g=0xc,a0h=0x18,a0i=(b,c)=>Array[a0Z(0x120)](b[a0Z(0x122)](c,c+0x10))[a0Z(0x121)](d=>d[a0Z(0xe1)](0x10)['padStart'](0x2,'0'))['join']('')[a0Z(0xeb)](/(.{8})(.{4})(.{4})(.{4})(.{12})/,a0Z(0x12e));export default{async 'fetch'(a,b){const a0=a0Z,c=new URL(a[a0(0xe8)]);if(a[a0(0x10b)][a0(0xf9)]('Upgrade')?.[a0(0x135)]()!==a0(0xe6))return new Response('OK',{'status':0xc8});const {proxyIP:d,socks5:e,enableSocks:f,globalProxy:g}=a0o(c[a0(0x144)]),{0x0:h,0x1:i}=new WebSocketPair();return i[a0(0x141)](),a0q(i,d,e,f,g),new Response(null,{'status':0x65,'webSocket':h});}};const a0j=a=>{const a1=a0Z,c=0x12+a[0x11]+0x1,d=a[c]<<0x8|a[c+0x1],e=a[c+0x2];let f=c+0x3,g,i;switch(e){case 0x1:i=0x4,g=a[a1(0x122)](f,f+i)[a1(0x117)]('.');break;case 0x2:i=a[f++],g=new TextDecoder()['decode'](a[a1(0x122)](f,f+i));break;case 0x3:i=0x10,g='['+Array[a1(0x120)]({'length':0x8},(j,k)=>(a[f+k*0x2]<<0x8|a[f+k*0x2+0x1])[a1(0xe1)](0x10))['join'](':')+']';break;default:throw new Error(a1(0xe0));}return{'host':g,'port':d,'payload':a[a1(0x122)](f+i),'addressType':e};},a0k=a=>{const a2=a0Z;if(a[a2(0x129)]('[')){const d=a['match'](/^\[(.+?)\]:(\d+)$/);if(d)return[d[0x1],Number(d[0x2])];return[a[a2(0x122)](0x1,-0x1),0x1bb];}const [b,c=0x1bb]=a[a2(0x136)](':');return[b,Number(c)];},a0l=a=>{const a3=a0Z;let b,c,d,e;if(a[a3(0xec)](a3(0xf8))&&!a['match'](/^(socks5?|https?):\/\//i)){const f=new URL(a);d=f[a3(0xfa)],e=f[a3(0x140)]||(f[a3(0x109)]==='http:'?0x50:0x438);const g=f['username']||f[a3(0x123)]?f[a3(0x12f)]+':'+f[a3(0x123)]:f[a3(0x12f)];if(g&&g[a3(0xec)](':'))[b,c]=g[a3(0x136)](':');else{if(g)try{const i=atob(g[a3(0xeb)](/%3D/g,'=')['padEnd'](g[a3(0x115)]+(0x4-g[a3(0x115)]%0x4)%0x4,'=')),j=i[a3(0x136)](':');if(j[a3(0x115)]===0x2)[b,c]=j;}catch{}}}else{let k='',l=a;const m=a[a3(0x125)]('@');m!==-0x1&&(k=a[a3(0x106)](0x0,m),l=a['substring'](m+0x1));if(k&&!k[a3(0xec)](':'))try{const q=atob(k[a3(0xeb)](/%3D/g,'=')[a3(0xe4)](k['length']+(0x4-k[a3(0x115)]%0x4)%0x4,'=')),r=q[a3(0x136)](':');if(r[a3(0x115)]===0x2)[b,c]=r;}catch{}if(!b&&k&&k[a3(0xec)](':'))[b,c]=k[a3(0x136)](':');const [n,o]=a0k(l);d=n,e=o||(a[a3(0xec)](a3(0xf0))?0x50:0x438);}if(!d||isNaN(e))throw new Error(a3(0xf4));return{'username':b,'password':c,'hostname':d,'port':e};};async function a0m(a,b,c,d){const a4=a0Z,{username:e,password:f,hostname:g,port:h}=d,i=connect({'hostname':g,'port':h}),j=i['writable'][a4(0xef)]();await j[a4(0x113)](new Uint8Array([0x5,e?0x2:0x1,0x0,e?0x2:0x0]));const k=i[a4(0xfd)][a4(0x12d)](),l=new TextEncoder();let m=(await k[a4(0xfe)]())[a4(0xe9)];if(m[0x1]===0x2){const o=new Uint8Array([0x1,e[a4(0x115)],...l[a4(0xfc)](e),f[a4(0x115)],...l[a4(0xfc)](f)]);await j[a4(0x113)](o),m=(await k[a4(0xfe)]())['value'];if(m[0x1]!==0x0)throw new Error(a4(0x112));}let n;if(a===0x1)n=new Uint8Array([0x1,...b['split']('.')[a4(0x121)](Number)]);else{if(a===0x2)n=new Uint8Array([0x3,b[a4(0x115)],...l[a4(0xfc)](b)]);else{if(a===0x3){const p=b[a4(0x122)](0x1,-0x1)[a4(0x136)](':')[a4(0x13c)](q=>[parseInt(q[a4(0x122)](0x0,0x2),0x10),parseInt(q[a4(0x122)](0x2,0x4),0x10)]);n=new Uint8Array([0x4,...p]);}}}await j[a4(0x113)](new Uint8Array([0x5,0x1,0x0,...n,c>>0x8&0xff,c&0xff])),m=(await k['read']())['value'];if(m[0x1]!==0x0)throw new Error(a4(0xde));return j[a4(0x110)](),k['releaseLock'](),i;}function a0a(){const ao=['pool','toLowerCase','split','addEventListener','socks5','91176vKrxhQ','forEach','577476TNiHqx','flatMap','Auth\x20failed','opened','Poor\x20network.','port','accept','1096470xZMkcV','Exhausted.','pathname','host','large','14bBORhp','data','SOCKS5\x20connect\x20failed','type','Invalid\x20address\x20type.','toString','enableLarge','\x20HTTP/1.1\x0d\x0a','padEnd','byteLength','websocket','decode','url','value','address','replace','includes','reset','tot','getWriter','http=','push','match','set','Invalid\x20proxy\x20config','HTTP\x20proxy\x20response\x20too\x20large','addressType','414453EXObct','://','get','hostname','cfg','encode','readable','read','writable','min','http','pow','ptr','Error.','free','substring','HTTP\x20proxy\x20closed\x20unexpectedly','Connection:\x20keep-alive\x0d\x0a\x0d\x0a','protocol','User-Agent:\x20Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/129.0.0.0\x20Safari/537.36\x0d\x0a','headers','error','random','buffered','alloc','releaseLock','adaptive','SOCKS5\x20auth\x20failed','write','buf','length','max','join','19606990WCMouG','direct','send','win','Proxy-Authorization:\x20Basic\x20','close','shift','now','from','map','slice','password','1962120vWldrJ','lastIndexOf','readyState','26598beCUDl','Invalid.','startsWith','floor','bee9ac63-20ea-4b0b-876a-09831e5f755a','buffer','getReader','$1-$2-$3-$4-$5','username','splice','socks','585hmJwGK','8yfrGLq'];a0a=function(){return ao;};return a0a();}async function a0n(a,b,c,d){const a5=a0Z,{username:e,password:f,hostname:g,port:h}=d,i=connect({'hostname':g,'port':h});let j='CONNECT\x20'+b+':'+c+a5(0xe3)+('Host:\x20'+b+':'+c+'\x0d\x0a');e&&f&&(j+=a5(0x11c)+btoa(e+':'+f)+'\x0d\x0a');j+=a5(0x10a)+a5(0x108);const k=i[a5(0xff)][a5(0xef)]();await k[a5(0x113)](new TextEncoder()[a5(0xfc)](j)),k['releaseLock']();const l=i[a5(0xfd)][a5(0x12d)]();let m=new Uint8Array(0x0);while(!![]){const {value:n,done:o}=await l[a5(0xfe)]();if(o)throw new Error(a5(0x107));const p=new Uint8Array(m['length']+n['length']);p[a5(0xf3)](m),p[a5(0xf3)](n,m[a5(0x115)]),m=p;if(m[a5(0x115)]>0x10000)throw new Error(a5(0xf5));const q=new TextDecoder()[a5(0xe7)](m);if(q[a5(0xec)]('\x0d\x0a\x0d\x0a')){if(/^HTTP\/1\.[01] 2/i['test'](q[a5(0x136)]('\x0d\x0a')[0x0]))return l[a5(0x110)](),i;throw new Error('HTTP\x20proxy\x20refused:\x20'+q['split']('\x0d\x0a')[0x0]);}}}function a0o(a){const a6=a0Z;let b=null,c=null,d=null,e=null;const f=a[a6(0xf2)](/(socks5?|https?):\/\/([^/#?]+)/i);if(f){const i=a0l(f[0x2]);return e={'type':f[0x1]['toLowerCase']()['includes']('5')||f[0x1]===a6(0x131)?a6(0x138):'http','cfg':i},{'proxyIP':b,'socks5':c,'enableSocks':d,'globalProxy':e};}const g=a['match'](/(?:^|\/)(?:proxy)?ip[=\/]([^?#]+)/i);if(g){const j=g[0x1],[k,l=0x1bb]=a0k(j);b={'address':k['includes']('[')?k['slice'](0x1,-0x1):k,'port':+l};}const h=a['match'](/(?:^|\/)(socks5?|s5|http)[=\/]([^/#?]+)/i);if(h){const m=h[0x2];c=a0l(m),d=h[0x1][a6(0x135)]()['includes'](a6(0x101))?a6(0x101):a6(0x138);}return{'proxyIP':b,'socks5':c,'enableSocks':d,'globalProxy':e};}class a0p{constructor(){const a7=a0Z;this[a7(0x114)]=new ArrayBuffer(0x4000),this[a7(0x103)]=0x0,this[a7(0x134)]=[],this[a7(0x116)]=0x8,this[a7(0xdb)]=![];}['alloc']=a=>{const a8=a0Z;if(a<=0x1000&&a<=0x4000-this[a8(0x103)]){const c=new Uint8Array(this['buf'],this[a8(0x103)],a);return this[a8(0x103)]+=a,c;}const b=this[a8(0x134)]['pop']();if(b&&b[a8(0xe5)]>=a)return new Uint8Array(b[a8(0x12c)],0x0,a);return new Uint8Array(a);};[a0Z(0x105)]=a=>{const a9=a0Z;if(a['buffer']===this[a9(0x114)]){this['ptr']=Math['max'](0x0,this[a9(0x103)]-a[a9(0x115)]);return;}if(this[a9(0x134)][a9(0x115)]<this['max']&&a['byteLength']>=0x400)this[a9(0x134)]['push'](a);};['enableLarge']=()=>{const aa=a0Z;this[aa(0xdb)]=!![];};[a0Z(0xed)]=()=>{const ab=a0Z;this[ab(0x103)]=0x0,this[ab(0x134)][ab(0x115)]=0x0,this[ab(0xdb)]=![];};}const a0q=(a,b,c,d,e)=>{const ac=a0Z,f=new a0p();let g,h,i,j,k=!![],l=0x0,m=0x0,n=0x0,o=Date[ac(0x11f)](),p=![],q=![];const s={},t=[];let u=0x0,v=0x1,x=Date[ac(0x11f)](),y=0x0,z=0x0,A=0x0,B={'tot':0x0,'cnt':0x0,'big':0x0,'win':0x0,'ts':Date[ac(0x11f)]()},C=ac(0x111),D=0x0,E=[];const F=N=>{const ad=ac;B[ad(0xee)]+=N,B['cnt']++;if(N>0x2000)B['big']++;D=D*0.9+N*0.1;const O=Date[ad(0x11f)]();if(O-B['ts']>0x3e8){const P=B['win'];E[ad(0xf1)](P);if(E[ad(0x115)]>0x5)E[ad(0x11e)]();B[ad(0x11b)]=N,B['ts']=O;const Q=E['reduce']((R,S)=>R+S,0x0)/E[ad(0x115)];if(B['cnt']>=0x14){if(Q<0x800000||D<0x1000)C!==ad(0x10e)&&(C='buffered',f[ad(0xe2)]());else{if(Q>0x1000000&&D>0x3000){if(C!==ad(0x119))C='direct';}else{if(C!==ad(0x111))C='adaptive';}}}}else B[ad(0x11b)]+=N;},G=async()=>{const af=ac;if(q)return;q=!![];let N=[],O=0x0,P=null;const Q=()=>{const ae=a0b;if(!O)return;const R=new Uint8Array(O);let S=0x0;for(const T of N){R[ae(0xf3)](T,S),S+=T[ae(0x115)];}if(a['readyState']===0x1)a[ae(0x11a)](R);N=[],O=0x0,P&&(clearTimeout(P),P=null);};try{while(!![]){if(u>a0d){await new Promise(T=>setTimeout(T,0x64));continue;}const {done:R,value:S}=await i['read']();if(S?.[af(0x115)]){l+=S[af(0x115)],o=Date[af(0x11f)](),m=0x0,F(S[af(0x115)]);const T=Date[af(0x11f)]();if(T-x>0x1388){const U=T-x,V=l-y,W=V/U;if(W>0x1f4)v=Math[af(0x100)](0x1,v+0.05);else{if(W<0x32)v=Math['max'](0.1,v-0.05);}x=T,y=l;}if(C===af(0x10e)){if(S[af(0x115)]<0x4000){N['push'](S),O+=S[af(0x115)];if(O>=0x10000)Q();else{if(!P)P=setTimeout(Q,D>0x2000?0x8:0x19);}}else{Q();if(a['readyState']===0x1)a[af(0x11a)](S);}}else{if(C===af(0x119)){Q();if(a[af(0x126)]===0x1)a['send'](S);}else{if(C==='adaptive'){if(S[af(0x115)]<0x2000){N['push'](S),O+=S[af(0x115)];if(O>=0xc000)Q();else{if(!P)P=setTimeout(Q,0xc);}}else{Q();if(a['readyState']===0x1)a['send'](S);}}}}}if(R){Q(),q=![],J();break;}}}catch(X){Q();if(P)clearTimeout(P);q=![],A++,J();}},H=async(N,O,P)=>{const ag=ac;if(e){if(e[ag(0xdf)]===ag(0x138))return await a0m(P,N,O,e['cfg']);if(e[ag(0xdf)]===ag(0x101))return await a0n(P,N,O,e[ag(0xfb)]);}try{const Q=connect({'hostname':N,'port':O});if(Q[ag(0x13e)])await Q[ag(0x13e)];return Q;}catch(R){if(!c&&!b)throw R;if(c)try{const S=d===ag(0x101)?await a0n(P,N,O,c):await a0m(P,N,O,c);if(S[ag(0x13e)])await S[ag(0x13e)];return S;}catch{}if(b)try{const T=connect({'hostname':b[ag(0xea)],'port':b[ag(0x140)]});if(T[ag(0x13e)])await T[ag(0x13e)];return T;}catch{}throw R;}},I=async()=>{const ah=ac;try{g=await H(j[ah(0xda)],j[ah(0x140)],j[ah(0xf6)]);if(g[ah(0x13e)])await g[ah(0x13e)];h=g['writable'][ah(0xef)](),i=g[ah(0xfd)][ah(0x12d)]();const N=t[ah(0x130)](0x0,0xa);for(const O of N){await h[ah(0x113)](O),u-=O[ah(0x115)],f['free'](O);}p=![],n=0x0,v=Math[ah(0x100)](0x1,v+0.15),z++,o=Date[ah(0x11f)](),G();}catch(P){p=![],A++,v=Math[ah(0x116)](0.1,v-0.2),J();}},J=async()=>{const ai=ac;if(!j||a['readyState']!==0x1){M(),a[ai(0x11d)](0x3f3,ai(0x128));return;}if(n>=a0h){M(),a[ai(0x11d)](0x3f3,'Max\x20reconnect.');return;}if(v<0.3&&n>0x5&&Math[ai(0x10d)]()>0.6){M(),a['close'](0x3f3,ai(0x13f));return;}if(p)return;n++;let N=Math[ai(0x100)](0x32*Math[ai(0x102)](1.5,n-0x1),0xbb8);N*=1.5-v*0.5,N+=(Math[ai(0x10d)]()-0.5)*N*0.2,N=Math[ai(0x116)](0x32,Math[ai(0x12a)](N));try{L();if(u>a0d*0x2)while(u>a0d&&t[ai(0x115)]>0x5){const P=t[ai(0x11e)]();u-=P[ai(0x115)],f[ai(0x105)](P);}await new Promise(Q=>setTimeout(Q,N)),p=!![],g=connect({'hostname':j[ai(0xda)],'port':j[ai(0x140)]}),await g['opened'],h=g[ai(0xff)][ai(0xef)](),i=g[ai(0xfd)]['getReader']();const O=t[ai(0x130)](0x0,0xa);for(const Q of O){await h[ai(0x113)](Q),u-=Q[ai(0x115)],f[ai(0x105)](Q);}p=![],n=0x0,v=Math['min'](0x1,v+0.15),z++,m=0x0,o=Date[ai(0x11f)](),G();}catch(R){p=![],A++,v=Math[ai(0x116)](0.1,v-0.2);if(n<a0h&&a[ai(0x126)]===0x1)setTimeout(J,0x1f4);else M(),a[ai(0x11d)](0x3f3,ai(0x143));}},K=()=>{s['ka']=setInterval(async()=>{const aj=a0b;if(!p&&h&&Date['now']()-o>a0e)try{await h[aj(0x113)](new Uint8Array(0x0)),o=Date['now']();}catch(N){J();}},a0e/0x3),s['hc']=setInterval(()=>{const ak=a0b;!p&&B[ak(0xee)]>0x0&&Date[ak(0x11f)]()-o>a0f&&(m++,m>=a0g&&(n<a0h?(m=0x0,J()):(M(),a[ak(0x11d)](0x3f3,'Stall.'))));},a0f/0x2);},L=()=>{const al=ac;q=![];try{h?.['releaseLock'](),i?.[al(0x110)](),g?.[al(0x11d)]();}catch{}},M=()=>{const am=ac;Object['values'](s)[am(0x13a)](clearInterval),L();while(t['length'])f['free'](t[am(0x11e)]());u=0x0,B={'tot':0x0,'cnt':0x0,'big':0x0,'win':0x0,'ts':Date['now']()},C=am(0x111),D=0x0,E=[],f['reset']();if(a[am(0x126)]===0x1)a[am(0x11d)](code,reason);};a[ac(0x137)]('message',async N=>{const an=ac;try{if(k){k=![];const O=new Uint8Array(N['data']);if(a0i(O,0x1)!==a0c)throw new Error(an(0x13d));const {host:P,port:Q,payload:R,addressType:S}=a0j(O);j={'host':P,'port':Q,'addressType':S},a[an(0x11a)](new Uint8Array([O[0x0],0x0])),p=!![];if(R[an(0x115)]){const T=f[an(0x10f)](R[an(0x115)]);T[an(0xf3)](R),t[an(0xf1)](T),u+=T[an(0x115)];}K(),I();}else{o=Date['now']();if(p||!h){const U=f['alloc'](N[an(0xdd)]['byteLength']);U[an(0xf3)](new Uint8Array(N['data'])),t[an(0xf1)](U),u+=U[an(0x115)];}else await h[an(0x113)](N[an(0xdd)]);}}catch(V){M(),a[an(0x11d)](0x3ee,an(0x104));}}),a['addEventListener'](ac(0x11d),M),a[ac(0x137)](ac(0x10c),M);};