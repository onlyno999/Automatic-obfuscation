const a0O=a0b;(function(a,b){const N=a0b,c=a();while(!![]){try{const d=parseInt(N(0x101))/0x1*(parseInt(N(0xe9))/0x2)+-parseInt(N(0xd1))/0x3+parseInt(N(0xb8))/0x4*(-parseInt(N(0x104))/0x5)+parseInt(N(0xa9))/0x6+parseInt(N(0xb5))/0x7*(parseInt(N(0xe5))/0x8)+parseInt(N(0x103))/0x9+-parseInt(N(0xb9))/0xa*(parseInt(N(0x10b))/0xb);if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0a,0x42a63));import{connect}from'cloudflare:sockets';let a0c='vl',a0d=a0O(0x115),a0e=a0O(0xd8),a0f=a0O(0xc2),a0g=a0O(0xac),a0h=![],a0i='',a0j=![],a0k='哎呀你找到了我，但是我就是不给你看，气不气，嘿嘿嘿',a0l=[a0O(0xee)],a0m=[''],a0n=a0O(0x8b),a0o=!![],a0p=!![],a0q='',a0r='',a0s=[],a0t=0x0;const a0u=0x5*0x3c*0x3e8,a0v=0x1388;function a0a(){const aa=['websocket','send','从\x20TCP\x20发送数据到\x20WebSocket\x20失败:','string','74573UlBtMx','replace','873315WQFgqy','5IIyyqb','pop','padStart','releaseLock','push','\x20失败，尝试通过SOCKS5代理:\x20','trim','4807bhuByJ','\x20个\x20SOCKS5\x20地址。','text/html;\x20charset=utf-8','error','SOCKS5_ENABLE','SOCKS5\x20地址列表文件为空或不含有效地址。将保留上次成功的列表（如果存在）。','传输管道已关闭。','关闭\x20WebSocket\x20失败:','join','warn','ess','value','SOCKS5\x20认证方式不支持:\x20','length','split','close','url','read','https://cloudflare-dns.com/dns-query','&sni=','SOCKS5版','关闭失败连接时出错:','addEventListener','race','toLowerCase',':443#备用节点','\x20记录','getReader','charCodeAt','SOCKS5_TXT_URL\x20未配置，不加载\x20SOCKS5\x20地址列表。','text/plain;charset=utf-8','pathname','reject','lastIndexOf','Upgrade','status','取消\x20TCP\x20读取器失败:','\x20请求失败:\x20','\x20失败\x20(IPv4\x20和\x20IPv6):\x20','请先关闭私钥功能','my-key','):\x20','Bad\x20Gateway:\x20','security=tls','&type=','连接超时:\x20','log','写入初始数据到\x20TCP\x20失败:','嘲讽语','SOCKS5_GLOBAL','2389620eXqsnA','拒绝DNS连接','\x20-\x20','35dce6e6-1c37-4e8c-806b-5ef8affd9f55','sec-websocket-protocol','message','代理失败:\x20','readable','无响应','catch','getWriter','所有\x20SOCKS5\x20代理尝试均失败。','77fbQzDl','\x20(Status:\x20','errors','365836kGsbIw','3370BiZfvx','无效的\x20IPv6\x20地址格式','\x20(代理\x20','headers','toString','byteLength','accept','https://1.1.1.1/dns-query','get','onlyno999','AAAA','。将使用备用\x20SOCKS5_ADDRESS\x20(如果已配置)\x20或上次成功加载的列表。','私钥开关','env','VL\x20协议解析或\x20TCP\x20连接失败:','收到非\x20ArrayBuffer\x20类型数据\x20(WebSocket):','Answer','正在并发尝试连接\x20SOCKS5\x20代理:\x20','cancel','map','未配置任何\x20SOCKS5\x20代理地址\x20(SOCKS5_TXT_URL\x20或\x20SOCKS5_ADDRESS)。','opened','无效的访问地址类型','直接连接目标\x20','926304hANdmZ','encode','无法获取或解析优选链接:\x20','https://dns.google/dns-query','加载\x20SOCKS5\x20地址列表失败:\x20','无效的UUID','isArray','://','data','false','\x0a1、本worker的私钥功能只支持通用订阅，其他请关闭私钥功能\x0a2、其他需求自行研究\x0a通用的：https','write','无认证','any','Host','text','writable','DOH\x20查询\x20','Hello\x20World!','filter','182264ezofHh','&path=%2F%3Fed%3D2560#','type','SOCKS5\x20认证协商响应无效。','2YBmfpy','https://dns.quad9.net/dns-query','我的节点名字','所有\x20SOCKS5\x20代理尝试均失败:','从\x20WebSocket\x20写入\x20TCP\x20失败:','cloudflare-ddns.zone.id:443#美国\x20域名\x20默认值\x20—\x20Cloudflare\x20CDN\x20节点','slice','from','释放\x20TCP\x20写入器锁失败:','getUint16','SOCKS5\x20代理连接失败或超时\x20(','正在加载\x20SOCKS5\x20地址列表...','then','从\x20TCP\x20读取数据失败:','includes','application/dns-json','body','SOCKS5目标地址连接失败，目标:\x20','find','startsWith'];a0a=function(){return aa;};return a0a();}let a0w=[a0O(0xd4),a0O(0x89),a0O(0xc0),a0O(0xea)],a0x='https://cf-worker-dir-bke.pages.dev/';async function a0y(){const P=a0O;try{const a=await fetch(a0x,{'cf':{'cacheEverything':!![]}});return new Response(a[P(0xf9)],a);}catch{return new Response('<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20<head><title>Welcome</title></head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20<body><h1>Cloudflare\x20Worker\x20已部署成功</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>此页面为静态伪装页面（远程加载失败）。</p></body>\x0a\x20\x20\x20\x20\x20\x20\x20</html>',{'status':0xc8,'headers':{'Content-Type':P(0x10d)}});}}const a0z=(a,b,c)=>{const Q=a0O,d=import.meta?.[Q(0xc6)]?.[a]??c?.[a];if(d===undefined||d===null||d==='')return b;if(typeof d===Q(0x100)){const e=d[Q(0x10a)]();if(e==='true')return!![];if(e===Q(0xda))return![];if(e[Q(0xf7)]('\x0a'))return e[Q(0x85)]('\x0a')['map'](f=>f[Q(0x10a)]())[Q(0xe4)](Boolean);if(!isNaN(e)&&e!=='')return Number(e);return e;}return d;};async function a0A(){const R=a0O;if(!a0r){console[R(0xa5)](R(0x94));return;}const a=Date['now']();if(a-a0t<a0u&&a0s['length']>0x0)return;console['log'](R(0xf4));try{const b=await fetch(a0r);if(!b['ok'])throw new Error('无法加载\x20SOCKS5\x20地址列表:\x20'+b['statusText']+R(0xb6)+b[R(0x9a)]+')');const c=await b[R(0xe0)](),d=c['split']('\x0a')[R(0xcc)](f=>f[R(0x10a)]())[R(0xe4)](f=>f&&!f[R(0xfc)]('#'));d[R(0x84)]>0x0?(a0s=d,a0t=a,console[R(0xa5)]('成功加载\x20'+a0s[R(0x84)]+R(0x10c))):console[R(0x114)](R(0x110));}catch(f){console['error'](R(0xd5)+f[R(0xae)]+R(0xc4));}}export default{async 'fetch'(a,b){const S=a0O;a0f=a0z('ID',a0f,b),a0g=a0z('UUID',a0g,b),a0l=a0z('IP',a0l,b),a0m=a0z('TXT',a0m,b),a0i=a0z('私钥',a0i,b),a0j=a0z('隐藏',a0j,b),a0h=a0z(S(0xc5),a0h,b),a0k=a0z(S(0xa7),a0k,b),a0n=a0z(S(0xeb),a0n,b),a0o=a0z(S(0x10f),a0o,b),a0p=a0z(S(0xa8),a0p,b),a0q=a0z('SOCKS5_ADDRESS',a0q,b),a0r=a0z('SOCKS5_TXT_URL',a0r,b),await a0A();const c=a[S(0xbc)]['get'](S(0x99)),d=new URL(a[S(0x87)]);if(!c||c!==S(0xfd)){if(a0m){const f=Array[S(0xd7)](a0m)?a0m:[a0m],g=[];for(const h of f){try{const i=await fetch(h),j=await i[S(0xe0)](),l=j[S(0x85)]('\x0a')[S(0xcc)](m=>m[S(0x10a)]())[S(0xe4)](m=>m);g[S(0x108)](...l);}catch(m){console[S(0x114)](S(0xd3)+h,m);}}if(g[S(0x84)]>0x0)a0l=g;}switch(d[S(0x96)]){case'/':return a0y();case'/'+a0f:{const n=a0L(a0f,a['headers']['get'](S(0xdf)));return new Response(n,{'status':0xc8,'headers':{'Content-Type':'text/plain;charset=utf-8'}});}case'/'+a0f+'/'+a0c+a0d:{if(a0j)return new Response(a0k,{'status':0xc8,'headers':{'Content-Type':S(0x95)}});else{const o=a0M(a[S(0xbc)]['get'](S(0xdf)));return new Response(o,{'status':0xc8,'headers':{'Content-Type':S(0x95)}});}}default:return new Response(S(0xe3),{'status':0xc8});}}else{if(a0h){const r=a[S(0xbc)][S(0xc1)](S(0x9f));if(r!==a0i)return new Response('私钥验证失败',{'status':0x193});}const p=a['headers'][S(0xc1)](S(0xad)),q=a0C(p);if(!a0h&&a0H(new Uint8Array(q[S(0xef)](0x1,0x11)))!==a0g)return new Response(S(0xd6),{'status':0x193});try{const {tcpSocket:s,initialData:t}=await a0D(q);return await a0B(a,s,t);}catch(u){return console[S(0x10e)](S(0xc7),u),new Response(S(0xa1)+u[S(0xae)],{'status':0x1f6});}}}};async function a0B(a,b,c){const T=a0O,{0x0:d,0x1:e}=new WebSocketPair();return e[T(0xbf)](),a0G(e,b,c),new Response(null,{'status':0x65,'webSocket':d});}function a0C(a){const U=a0O;return a=a[U(0x102)](/-/g,'+')[U(0x102)](/_/g,'/'),Uint8Array[U(0xf0)](atob(a),b=>b[U(0x93)](0x0))['buffer'];}async function a0D(a){const V=a0O,d=new DataView(a),f=new Uint8Array(a),g=f[0x11],h=0x12+g+0x1,j=d[V(0xf2)](h);if(j===0x35)throw new Error(V(0xaa));const k=h+0x2;let l=f[k],m=k+0x1,n,o;switch(l){case 0x1:o=0x4,n=Array[V(0xf0)](f[V(0xef)](m,m+o))[V(0x113)]('.');break;case 0x2:o=f[m],m+=0x1;const r=new TextDecoder()['decode'](f[V(0xef)](m,m+o));n=await a0K(r);n!==r&&(l=n[V(0xf7)](':')?0x3:0x1);break;case 0x3:o=0x10;const s=[],t=new DataView(a,m,0x10);for(let u=0x0;u<0x8;u++)s[V(0x108)](t[V(0xf2)](u*0x2)['toString'](0x10));n=s[V(0x113)](':');break;default:throw new Error(V(0xcf));}const p=a[V(0xef)](m+o);let q;if(a0o){if(a0p)q=await a0E(l,n,j);else try{q=connect({'hostname':n,'port':j}),await q['opened'];}catch(v){console[V(0x114)](V(0xd0)+n+':'+j+V(0x109)+v[V(0xae)]),q=await a0E(l,n,j);}}else q=connect({'hostname':n,'port':j});return await q[V(0xce)],{'tcpSocket':q,'initialData':p};}function a0b(a,b){const c=a0a();return a0b=function(d,e){d=d-0x84;let f=c[d];return f;},a0b(a,b);}async function a0E(a,b,c){const W=a0O;let d=[];a0s[W(0x84)]>0x0&&(d=[...a0s]);d[W(0x84)]===0x0&&a0q&&d[W(0x108)](a0q);if(d['length']===0x0)throw new Error(W(0xcd));const e=d[W(0xcc)](async(f,g)=>{const X=W;let h=null;try{const {账号:i,密码:j,地址:k,端口:l}=await a0I(f);console['log'](X(0xca)+(i?'带认证':X(0xdd))+'\x20'+k+':'+l+X(0xbb)+(g+0x1)+'/'+d[X(0x84)]+')');const m=new Promise((n,o)=>{const p=setTimeout(()=>{const Y=a0b;o(new Error(Y(0xa4)+k+':'+l));},a0v);});return h=await Promise[X(0x8e)]([a0F(i,j,k,l,a,b,c),m]),console[X(0xa5)]('成功连接\x20SOCKS5\x20代理:\x20'+k+':'+l),{'socket':h,'config':f};}catch(n){console[X(0x114)](X(0xf3)+f+X(0xa0)+n[X(0xae)]);if(h)try{h[X(0x86)]();}catch(o){console[X(0x114)](X(0x8c),o);}return Promise['reject'](new Error(X(0xaf)+f+X(0xab)+n['message']));}});try{const {socket:f,config:g}=await Promise[W(0xde)](e);return f;}catch(h){console[W(0x10e)](W(0xec),h[W(0xb7)][W(0xcc)](i=>i[W(0xae)])[W(0x113)](';\x20'));throw new Error(W(0xb4));}}async function a0F(a,b,c,d,f,g,h){const Z=a0O,k=connect({'hostname':c,'port':d});let l,m;try{await k['opened'],l=k[Z(0xe1)][Z(0xb3)](),m=k[Z(0xb0)][Z(0x92)]();const n=new TextEncoder(),o=new Uint8Array([0x5,0x2,0x0,0x2]);await l[Z(0xdc)](o);const p=(await m[Z(0x88)]())[Z(0x116)];if(!p||p[Z(0x84)]<0x2)throw new Error(Z(0xe8));if(p[0x1]===0x2){if(!a||!b)throw new Error('SOCKS5\x20代理需要认证，但未配置账号密码。');const t=new Uint8Array([0x1,a[Z(0x84)],...n[Z(0xd2)](a),b['length'],...n['encode'](b)]);await l[Z(0xdc)](t);const u=(await m['read']())[Z(0x116)];if(!u||u['length']<0x2||u[0x0]!==0x1||u[0x1]!==0x0)throw new Error('SOCKS5\x20账号密码错误或认证失败。');}else{if(p[0x1]===0x0){}else throw new Error(Z(0x117)+p[0x1]);}let q;switch(f){case 0x1:q=new Uint8Array([0x1,...g['split']('.')[Z(0xcc)](Number)]);break;case 0x2:q=new Uint8Array([0x3,g[Z(0x84)],...n[Z(0xd2)](g)]);break;case 0x3:const v=g[Z(0x85)](':'),w=[];let x=![];for(let y=0x0;y<v[Z(0x84)];y++){let z=v[y];if(z===''){if(!x){let A=0x8-(v[Z(0x84)]-0x1);if(v[0x0]===''&&y===0x0)A++;if(v[v['length']-0x1]===''&&y===v[Z(0x84)]-0x1)A++;for(let B=0x0;B<A;B++){w['push'](0x0,0x0);}x=!![];}}else{let C=parseInt(z,0x10);w['push'](C>>0x8&0xff,C&0xff);}}while(w[Z(0x84)]<0x10){w[Z(0x108)](0x0,0x0);}q=new Uint8Array([0x4,...w]);break;default:throw new Error('无效的SOCKS5目标地址类型');}const r=new Uint8Array([0x5,0x1,0x0,...q,h>>0x8,h&0xff]);await l[Z(0xdc)](r);const s=(await m[Z(0x88)]())[Z(0x116)];if(!s||s[Z(0x84)]<0x2||s[0x0]!==0x5||s[0x1]!==0x0)throw new Error(Z(0xfa)+g+':'+h+',\x20SOCKS5响应码:\x20'+(s?s[0x1]:Z(0xb1)));return l[Z(0x107)](),m['releaseLock'](),k;}catch(D){if(l)l[Z(0x107)]();if(m)m[Z(0x107)]();if(k)k[Z(0x86)]();throw D;}}async function a0G(a,b,c){const a0=a0O;a[a0(0xfe)](new Uint8Array([0x0,0x0]));const d=b[a0(0xe1)][a0(0xb3)](),f=b[a0(0xb0)]['getReader']();c&&c[a0(0xbe)]>0x0&&await d['write'](c)[a0(0xb2)](g=>console[a0(0x10e)](a0(0xa6),g));a[a0(0x8d)]('message',async g=>{const a1=a0;if(g[a1(0xd9)]instanceof ArrayBuffer)try{await d[a1(0xdc)](g['data']);}catch(h){console[a1(0x10e)](a1(0xed),h);}else console[a1(0x114)](a1(0xc8),g[a1(0xd9)]);});try{while(!![]){const {value:g,done:h}=await f[a0(0x88)]();if(h)break;if(g)try{a[a0(0xfe)](g);}catch(i){console[a0(0x10e)](a0(0xff),i);break;}}}catch(j){console[a0(0x10e)](a0(0xf6),j);}finally{try{a['close']();}catch(k){console[a0(0x114)](a0(0x112),k);}try{f[a0(0xcb)]();}catch(l){console[a0(0x114)](a0(0x9b),l);}try{d[a0(0x107)]();}catch(m){console[a0(0x114)](a0(0xf1),m);}try{b['close']();}catch(n){console['warn']('关闭\x20TCP\x20连接失败:',n);}console[a0(0xa5)](a0(0x111));}}function a0H(b){const a2=a0O,c=Array['from'](b,d=>d[a2(0xbd)](0x10)[a2(0x106)](0x2,'0'))['join']('');return c[a2(0xef)](0x0,0x8)+'-'+c[a2(0xef)](0x8,0xc)+'-'+c[a2(0xef)](0xc,0x10)+'-'+c[a2(0xef)](0x10,0x14)+'-'+c[a2(0xef)](0x14);}async function a0I(a){const a3=a0O,b=a[a3(0x98)]('@');if(b===-0x1){const [j,k]=a0J(a);return{'账号':'','密码':'','地址':j,'端口':k};}const c=a[a3(0xef)](0x0,b),d=a[a3(0xef)](b+0x1),e=c[a3(0x98)](':'),f=e>-0x1?c[a3(0xef)](0x0,e):'',g=e>-0x1?c[a3(0xef)](e+0x1):'',[h,i]=a0J(d);return{'账号':f,'密码':g,'地址':h,'端口':i};}function a0J(a){const a4=a0O;let b,c;if(a[a4(0xfc)]('[')){const d=a['indexOf'](']');if(d===-0x1)throw new Error(a4(0xba));b=a[a4(0xef)](0x1,d);const e=a[a4(0xef)](d+0x1);c=e[a4(0xfc)](':')?Number(e[a4(0xef)](0x1)):0x1bb;if(isNaN(c)||c<=0x0||c>0xffff)c=0x1bb;}else{const f=a['lastIndexOf'](':');f>-0x1&&!isNaN(Number(a[a4(0xef)](f+0x1)))?(b=a[a4(0xef)](0x0,f),c=Number(a[a4(0xef)](f+0x1))):(b=a,c=0x1bb);}return[b,c];}async function a0K(a){const a5=a0O,b=c=>a0w[a5(0xcc)](d=>fetch(d+'?name='+a+a5(0xa3)+c,{'headers':{'Accept':a5(0xf8)}})[a5(0xf5)](f=>f['json']())[a5(0xf5)](f=>{const a6=a5,g=f[a6(0xc9)]?.[a6(0xfb)](h=>h[a6(0xe7)]===(c==='A'?0x1:0x1c))?.[a6(0xd9)];if(g)return g;return Promise[a6(0x97)]('无\x20'+c+a6(0x91));})[a5(0xb2)](f=>Promise['reject'](d+'\x20'+c+a5(0x9c)+f)));try{return await Promise[a5(0xde)](b('A'));}catch(c){try{return await Promise[a5(0xde)](b(a5(0xc3)));}catch(d){return console[a5(0x114)](a5(0xe2)+a+a5(0x9d)+d[a5(0xae)]),a;}}}function a0L(a,b){const a7=a0O;return a7(0xdb)+a0e+b+'/'+a+'/'+a0c+a0d+'\x0a';}function a0M(a){const a8=a0O,b=a0l[a8(0x84)]===0x0||a0l['length']===0x1&&a0l[0x0]==='',c=a0m[a8(0x84)]===0x0||a0m[a8(0x84)]===0x1&&a0m[0x0]==='',d=!b||!c?a0l:[a+a8(0x90)];return a0h?a8(0x9e):d[a8(0xcc)](e=>{const a9=a8,f=e[a9(0x85)]('@');let g=f[0x0],h=a9(0xa2);if(f[a9(0x84)]>0x1){const n=f[0x1];n[a9(0x8f)]()==='notls'&&(h='security=none');}const [i,j=a0n]=g[a9(0x85)]('#'),k=i[a9(0x85)](':'),l=k['length']>0x1&&!isNaN(Number(k[k['length']-0x1]))?Number(k[a9(0x105)]()):0x1bb,m=k[a9(0x113)](':');return''+a0c+a0d+a0e+a0g+'@'+m+':'+l+'?encryption=none&'+h+a9(0x8a)+a+'&type=ws&host='+a+a9(0xe6)+j;})['join']('\x0a');}